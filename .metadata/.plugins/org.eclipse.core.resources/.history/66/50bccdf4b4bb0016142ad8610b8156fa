package week7;

import java.util.ArrayList;

public class PandaSocialNetwork {
	private class Wrapper {
		private Panda self;
		private ArrayList<Panda> friends;
	
		private Wrapper(Panda p) {
			self = p;
		}
		
		private boolean equals(Wrapper o) {
			return self == o.self;
		}
		
		private void setFriend(Panda o) {
			if(!friends.contains(o)) {
				friends.add(o);				
			}
		}
	}
	
	private ArrayList<Wrapper> pandas = new ArrayList<Wrapper>();
	
	public void add(Panda p) {
		pandas.add(new Wrapper(p));
	}
	
	public boolean hasPanda(Panda p) {
		boolean result = false;
		for (Wrapper w : pandas) {
			if(w.self == p) {
				result = true;
			}
		}
		return result;
	}
	
	public void makeFriends(Panda p1, Panda p2) {
		if(!hasPanda(p1)) {
			add(p1);
		}
		
		if(!hasPanda(p2)) {
			add(p2);
		}
		
		getWrapper(p1).setFriend(p2);
		getWrapper(p2).setFriend(p1);
	}
	
	private Wrapper getWrapper(Panda p1) {
		Wrapper result = null;
		
		for (Wrapper w : pandas) {
			if(w.self.equals(new Wrapper(p1))) {
				result = w;
				break;
			}
		}
		
		return result;
	}
	
	public boolean areFriends(Panda p1, Panda p2) throws Exception {
		Wrapper panda1 = getWrapper(p1);
		if (panda1 == null) {
			throw new Exception("No such panda" + p1);
		}
		
		return panda1.friends.contains(new Wrapper(p2));
	}
	
	public ArrayList<Panda> friendsOf(Panda p) throws Exception {
		for (Wrapper w : pandas) {
			if(w.self == p) {
				return w.friends;
			}
		}
		
		String message = "No such panda - " + p;
		throw new Exception(message);
	}
	
	
	public void printNetwork() {
		for (Wrapper w : pandas) {
			System.out.println(w.self);
			System.out.println("-------------");
		}
	}
	
	public static void main(String[] args) throws Exception {
		Panda goshko = new Panda("goshko", "debel@sam.bg", "male");
		Panda emo = new Panda("emo", "ucha@java.az", "male");
		Panda ivan = new Panda("ivan", "ivan@van.az", "male");
		Panda ivan2 = new Panda("ivan2", "ivan2@van.az", "male");
		Panda jenskapanda = new Panda("jena", "drama@sigurna.bg", "female");

		PandaSocialNetwork psn = new PandaSocialNetwork();
		psn.add(goshko);
		psn.add(emo);
		psn.add(jenskapanda);
		
		psn.printNetwork();
		
		System.out.println( psn.hasPanda(emo) );
		System.out.println( psn.hasPanda(ivan) );
		psn.makeFriends(ivan, ivan2);
		System.out.println( psn.areFriends(emo, goshko) );
		System.out.println( psn.areFriends(jenskapanda, goshko) );
		
	}
}
